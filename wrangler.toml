name = "kids-reading-manager"
main = "src/worker.js"
compatibility_date = "2025-04-09"
compatibility_flags = ["nodejs_compat"]

# KV Namespace for storing application data (students, classes, settings, genres)
# IMPORTANT: Before deploying, you must create the KV namespace using Wrangler CLI:
#   1. Create production namespace: wrangler kv:namespace create READING_MANAGER_KV
#   2. Create preview namespace: wrangler kv:namespace create READING_MANAGER_KV --preview
#   3. Copy the namespace IDs from the output and replace the placeholders below
kv_namespaces = [
  { binding = "READING_MANAGER_KV", id = "09297a22cb3b4abc96bf0a5d4c79b4e9", preview_id = "6b452436a7794d36810e929dde07debf" }
]

# D1 Database for storing books (scalable SQL storage for large book collections)
# Created with: npx wrangler d1 create reading-manager-db
[[d1_databases]]
binding = "READING_MANAGER_DB"
database_name = "reading-manager-db"
database_id = "30afac38-bccf-436b-8197-b59dabc73384"
# Configuration for serving static assets (React frontend)
[assets]
directory = "./build"
not_found_handling = "single-page-application"

# Environment variables
[vars]
ENVIRONMENT = "production"
STORAGE_TYPE = "kv"

# Development environment variables
[env.dev]
[env.dev.vars]
ENVIRONMENT = "development"
STORAGE_TYPE = "json"

# Static assets configuration for serving the React frontend
# [site] block removed (deprecated)
# Bind to a custom domain or subdomain if needed
# [routes]
# pattern = "https://kids-reading-manager.example.com/*"
# zone_name = "example.com"

# Triggers
[triggers]
crons = []

[observability.logs]
enabled = true